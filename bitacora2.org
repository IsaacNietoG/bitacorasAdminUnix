#+TITLE: Bitácora Semanal 2: Administración de Sistemas Unix
#+AUTHOR: Equipo Alpine White
#+DATE: [2026-02-09 lun]
#+OPTIONS: toc:2
#+PROPERTY: header-args :exports both
#+LATEX_CLASS: article
#+LATEX_CLASS_OPTIONS: [11pt, letterpaper]
#+LATEX_HEADER: \usepackage[margin=2.5cm]{geometry}      % Márgenes decentes
#+LATEX_HEADER: \usepackage[utf8]{inputenc}
#+LATEX_HEADER: \usepackage{palatino}                   % Tipografía elegante
#+LATEX_HEADER: \usepackage{xcolor}                     % Colores personalizados

* Información General
- *Semana:* Del 9 de Febrero 2026 al 13 de Febrero 2026
- *Equipo:*
  - Arreguín Salgado Gael Emiliano
  - Gramer Muñoz Omar Fernando
  - López Pérez Mariana
  - Nieto Gallegos Isaac Julián

Durante la semana vimos una variedad de comandos que nos permiten ver el potencial de configurabilidad que existe dentro de Linux. Particularmente, estuvimos trabajando en permisos de archivos, montaje de sistemas de archivos y vamos comenzando a prepararnos para la virtualización.

* Comandos de Administración en Linux

Definiciones de Comandos de Administración en Linux

| Comando | Definición |
|---------+------------|
| dmesg \| less | Muestra el registro del kernel (mensajes del sistema), incluyendo detección de hardware, particiones, errores de disco y eventos al arrancar. El uso de `less` permite navegar el historial página por página. |
| fdisk -l /dev/sdf | Lista la tabla de particiones del disco especificado. Muestra tamaño, tipo (EFI, Linux, HPFS/NTFS), sectores y UUID. Es útil para identificar cómo está organizada la memoria o el disco. |
| p (en fdisk) | Dentro del intérprete interactivo de fdisk, el comando `p` imprime (print) la tabla actual de particiones. |
| n (en fdisk) | Crea una nueva partición dentro del disco seleccionado. Permite elegir tipo (primaria, extendida) y tamaño. |
| gpart | Herramienta para analizar y recuperar tablas de particiones dañadas. Puede reconstruir estructuras perdidas en discos. |
| smart | Hace referencia a SMART (Self-Monitoring, Analysis and Reporting Technology), sistema que monitorea el estado físico del disco para detectar fallos. Normalmente se usa con `smartctl`. |
| efibootmgr | Administra las entradas de arranque EFI. Permite ver, crear o modificar el orden de arranque almacenado en la memoria NVRAM del sistema. |
| df -l | Muestra los sistemas de archivos montados excluyendo los remotos. Indica cuánto espacio está usado y disponible. |
| df -lh | Igual que `df`, pero en formato legible (human readable), mostrando tamaños en KB, MB o GB. |
| mount /dev/sda3 /mnt | Monta una partición en un directorio para poder acceder a su contenido. Integra el sistema de archivos al árbol principal. |
| umount /mnt | Desmonta una partición previamente montada, liberando el punto de montaje. |
| mount -o subvol=home /dev/sda3 /mnt | Monta un subvolumen específico en sistemas Btrfs. Permite separar /home de la raíz del sistema. |
| mount --bind /dev /mnt/dev | Realiza un montaje enlazado (bind mount), permitiendo que un directorio aparezca en otra ubicación. Es común antes de usar `chroot`. |
| mount --bind /sys /mnt/sys | Similar al anterior, enlaza el directorio del sistema para que esté disponible dentro de un entorno chroot. |
| less /etc/fstab | Muestra el archivo de configuración donde se definen los sistemas de archivos que se montan automáticamente al iniciar el sistema. |
| less /etc/mtab | Muestra los sistemas de archivos actualmente montados. |
| cat /etc/os-release | Muestra información sobre la distribución del sistema operativo (nombre, versión, ID). |
| chroot /mnt bash | Cambia la raíz del sistema al directorio indicado y ejecuta un shell (bash). Permite administrar o reparar un sistema desde otro entorno. |

* Montaje de Particiones, EFI y Administración del Sistema

------------------------------------------------------------
* 1. Identificación y Montaje de Particiones

En clase analizamos cómo identificar las particiones del sistema y montarlas
manualmente utilizando el directorio /mnt como punto temporal de montaje.

El directorio /mnt está definido por el FHS (Filesystem Hierarchy Standard)
como un punto destinado a montajes temporales realizados por el administrador.

El proceso general consistió en:

- Identificar las particiones con herramientas como fdisk o lsblk.
- Reconocer la partición raíz (/), la partición /boot y la partición /boot/efi.
- Montar manualmente las particiones para inspeccionar su contenido.
- Analizar la estructura interna del sistema de archivos.

------------------------------------------------------------
* 2. EFI (EFI System Partition)

La EFI System Partition (ESP) es una partición especial utilizada en sistemas
modernos que emplean UEFI (Unified Extensible Firmware Interface) en lugar del
BIOS tradicional.

** Características principales:
- Formateada generalmente en FAT32.
- Contiene los cargadores de arranque (.efi).
- Se monta comúnmente en /boot/efi.
- Es requerida en sistemas con tabla de particiones GPT.

** Proceso de arranque en sistemas UEFI:
1. Encendido del equipo.
2. Ejecución del firmware (UEFI).
3. Localización de la partición EFI.
4. Carga del bootloader (ej. GRUB).
5. Selección y carga del kernel.
6. Inicio del sistema operativo.

La EFI permite mayor flexibilidad, soporte para discos mayores a 2TB y
mecanismos como Secure Boot.

------------------------------------------------------------
* 3. Dispositivos tipo /dev/sdX y contexto de "sd3"

En Linux, los dispositivos de almacenamiento se representan como block devices dentro del directorio /dev.

Ejemplos:
- /dev/sda  → Primer disco detectado
- /dev/sdb  → Segundo disco
- /dev/sda1 → Primera partición del disco sda
- /dev/sda3 → Tercera partición del disco sda

Cuando se mencionó “sd3”, se hacía referencia probablemente a /dev/sda3, que corresponde a una partición específica del disco principal. Esta partición
puede contener:

- La raíz del sistema (/)
- Un subvolumen en Btrfs
- El directorio /home
- Otro sistema de archivos independiente

En sistemas modernos es común que la raíz esté en /dev/sda3 utilizando Btrfs. Ya que las primeras dos particiones suelen justamente dedicarse al arranque, o a otro sistema.

------------------------------------------------------------
* 4. Buenas prácticas: uso de usuario con privilegios sudo

Una recomendación importante fue evitar trabajar directamente como root.

** Justificación técnica:

En sistemas Unix existe separación de privilegios:

- Usuario normal → permisos limitados.
- Root (UID 0) → control total del sistema.

Trabajar siempre como root implica riesgos:
- Eliminación accidental de archivos críticos.
- Modificación indebida de configuraciones.
- Mayor impacto ante errores humanos.

** Buena práctica recomendada:
- Crear un usuario administrador.
- Asignarlo al grupo sudo o wheel.
- Elevar privilegios únicamente cuando sea necesario usando sudo.

Esto sigue el principio de:
#+BEGIN_QUOTE
Principio de mínimo privilegio (Principle of Least Privilege)
#+END_QUOTE

Este principio es ampliamente recomendado en comunidades técnicas,
documentación oficial y foros especializados en administración Linux.

------------------------------------------------------------
* 5. Sistema de archivos Btrfs

Se revisó el uso del sistema de archivos Btrfs, el cual es moderno y avanzado,
diseñado para ofrecer:

- Copy-on-Write (CoW)
- Snapshots
- Subvolúmenes
- Compresión
- Integridad de datos

------------------------------------------------------------
* 5.1 Opción compress=zstd:1 0 0

La opción:

compress=zstd:1

es una opción de montaje en Btrfs que habilita compresión usando Zstandard.

** Componentes:
- compress → activa compresión.
- zstd → algoritmo Zstandard.
- :1 → nivel de compresión (1 = bajo, más rápido).

Ventajas:
- Reduce uso de espacio en disco.
- Mejora rendimiento en ciertos escenarios (menos I/O).
- Transparente para el usuario.

En /etc/fstab suele verse algo como:

UUID=xxxxx  /  btrfs  defaults,compress=zstd:1  0  0

Los últimos dos valores (0 0) indican:
- Dump (respaldo) → generalmente 0.
- Orden de chequeo con fsck → generalmente 0 en Btrfs.

------------------------------------------------------------
* 5.2 Subvolúmenes (subvol)

Un subvolumen en Btrfs es una división lógica dentro del mismo sistema de
archivos.

No es una partición física, sino una estructura interna.

Ejemplo común:

- Subvolumen @        → raíz del sistema
- Subvolumen @home    → directorio /home

Ventajas:
- Permite snapshots independientes.
- Separación lógica sin particionar físicamente.
- Facilita recuperación y administración.

Montaje ejemplo:

mount -o subvol=@home /dev/sda3 /mnt

------------------------------------------------------------
* 6. Archivo /etc/fstab

El archivo /etc/fstab define qué sistemas de archivos se montan al inicio.

Incluye:
- UUID
- Punto de montaje
- Tipo de sistema de archivos
- Opciones de montaje
- Flags de dump y fsck

Es clave en administración Unix para garantizar persistencia de configuración.

------------------------------------------------------------
* 7. Conceptos Complementarios Propuestos

A continuación se listan temas estructurales para desarrollo posterior
dentro de la materia Administración de Unix.

Esta semana permitió comprender cómo Unix/Linux organiza el almacenamiento
desde el nivel físico hasta el nivel lógico, cómo se monta el sistema de
archivos y cómo el proceso de arranque interactúa con la EFI y el bootloader.

Asimismo, se reforzaron buenas prácticas administrativas como el uso de
usuarios con privilegios controlados y la comprensión del sistema de archivos
Btrfs y sus capacidades avanzadas.

Estos conocimientos constituyen una base esencial para la administración
segura y eficiente de sistemas Unix.



* 8. Estructura lógica y administración de sistemas de archivos

** ¿Qué es un sistema de archivos?

Un sistema de archivos (Filesystem) es el mecanismo lógico que utiliza el
sistema operativo para organizar, almacenar y recuperar datos en un
dispositivo de almacenamiento.

*** Organización lógica de datos
Permite estructurar la información en archivos y directorios jerárquicos,
independientemente de cómo estén físicamente almacenados los bloques
en el disco.

Ejemplo:
Un archivo llamado documento.txt puede estar dividido en múltiples
bloques físicos, pero el sistema lo presenta como una unidad lógica.

*** Relación con particiones
Un sistema de archivos se crea sobre una partición o dispositivo.
La partición define el espacio físico; el sistema de archivos define
cómo se organiza ese espacio.

Disco → Partición → Sistema de archivos → Archivos y directorios

*** Abstracción sobre el hardware
El sistema de archivos actúa como una capa de abstracción entre el
usuario y el hardware, ocultando detalles como sectores, cilindros
y bloques físicos.

---

** Sistemas de archivos comunes en Linux

*** ext4
Sistema de archivos por defecto en muchas distribuciones Linux.
Soporta journaling, archivos grandes y buena estabilidad.

*** xfs
Optimizado para alto rendimiento y manejo de grandes volúmenes
de datos. Muy usado en servidores.

*** btrfs
Sistema moderno con características avanzadas como snapshots,
compresión y subvolúmenes.

*** vfat
Compatible con sistemas Windows. Usado comúnmente en memorias USB.

*** ntfs
Sistema de archivos de Windows. Linux puede leerlo y escribirlo
mediante controladores como ntfs-3g.

---

** Estructura interna básica de un archivo

*** Superbloque
Contiene información global del sistema de archivos:
- Tamaño total
- Número de inodos
- Tamaño de bloque
- Estado del sistema

Es esencial para montar el sistema.

*** Inodos
Estructuras que almacenan metadatos del archivo:
- Permisos
- Propietario
- Tamaño
- Punteros a bloques de datos

Importante: el nombre del archivo NO está en el inodo,
sino en el directorio.

*** Bloques de datos
Son las unidades físicas donde se almacena el contenido real
del archivo.

*** Journaling
Mecanismo que registra cambios antes de aplicarlos.
Permite recuperación ante fallos inesperados (apagones).

Ejemplo:
ext4 usa journaling para evitar corrupción tras un corte eléctrico.

*** Metadatos
Información sobre el archivo, no su contenido.
Ejemplo:
- Fecha de creación
- Permisos
- Tamaño
- UID y GID

---

** Creación y formateo de particiones

Formatear significa crear un sistema de archivos dentro
de una partición.

*** mkfs
Comando general para crear sistemas de archivos.

Ejemplo:
#+begin_src bash
mkfs -t ext4 /dev/sdb1
#+end_src

*** mkfs.ext4
Forma específica para crear ext4.

#+begin_src bash
mkfs.ext4 /dev/sdb1
#+end_src

*** mkfs.xfs
Para crear sistema de archivos XFS.

#+begin_src bash
mkfs.xfs /dev/sdb1
#+end_src

*** Verificación con fsck
Herramienta para revisar y reparar sistemas de archivos.

#+begin_src bash
fsck /dev/sdb1
#+end_src

---

** Montaje

Montar significa asociar un sistema de archivos
a un directorio del sistema.

*** mount
Permite montar manualmente.

#+begin_src bash
mount /dev/sdb1 /mnt
#+end_src

*** umount
Desmonta el sistema.

#+begin_src bash
umount /mnt
#+end_src

*** Puntos de montaje (/mnt, /media)
- /mnt → montajes temporales manuales.
- /media → dispositivos removibles (USB).

*** Montaje temporal vs permanente
Temporal:
Se pierde al reiniciar.

Permanente:
Se configura en /etc/fstab para montarse automáticamente.

---

** Archivo /etc/fstab

Archivo de configuración que define qué sistemas de archivos
se montan al inicio.

Formato general:
dispositivo   punto_montaje   tipo   opciones   dump   pass

*** Montaje automático al inicio
Permite que las particiones se monten automáticamente
durante el arranque.

*** UUID vs nombre de dispositivo
- /dev/sda1 puede cambiar.
- UUID es único y estable.

Ejemplo:
#+begin_src bash
UUID=xxxx-xxxx /home ext4 defaults 0 2
#+end_src

*** Opciones comunes
- defaults → configuración estándar
- noatime → no actualiza fecha de acceso
- ro → solo lectura
- rw → lectura y escritura

---------------------------------------------------------------------------

* 9. Organización del sistema, permisos y almacenamiento avanzado

** FHS (Filesystem Hierarchy Standard)

Estándar que define cómo se organizan los directorios
en sistemas Unix/Linux.

Garantiza consistencia entre distribuciones.

---

** Estructura de directorios

*** /
Raíz del sistema. Todo parte desde aquí.

*** /home
Directorios personales de los usuarios.

*** /etc
Archivos de configuración del sistema.

*** /var
Archivos variables:
- logs
- bases de datos
- spool

*** /usr
Programas y bibliotecas del sistema.

*** /boot
Archivos necesarios para el arranque:
- kernel
- initramfs
- bootloader

*** /dev
Archivos especiales que representan dispositivos.

Ejemplo:
/dev/sda → disco
/dev/null → dispositivo nulo

*** /proc
Sistema virtual que expone información del kernel
y procesos en tiempo real.

*** /sys
Sistema virtual que expone información del hardware
y dispositivos.

---

** Permisos y Propiedad

Cada archivo tiene permisos para:
- Usuario (owner)
- Grupo
- Otros

*** Lectura (r)
Permite ver contenido.

*** Escritura (w)
Permite modificar.

*** Ejecución (x)
Permite ejecutar como programa.

*** Ver permisos
#+begin_src bash
ls -la
#+end_src

Ejemplo de salida:
-rwxr-xr-- 1 user group 1024 archivo.sh

---

** Conceptos de Usuarios y grupos

*** Propietario
Usuario dueño del archivo.

*** Grupo
Conjunto de usuarios con permisos compartidos.

*** Otros
Todos los demás usuarios.

*** Comandos relacionados

**** chmod
Modifica permisos.

#+begin_src bash
chmod 755 archivo.sh
#+end_src

**** chown
Cambia propietario.

#+begin_src bash
chown user archivo.txt
#+end_src

**** chgrp
Cambia grupo.

#+begin_src bash
chgrp developers archivo.txt
#+end_src

---

** Permisos especiales

*** SUID
Permite ejecutar un archivo con privilegios del propietario.

Ejemplo típico:
passwd

*** SGID
Similar al SUID pero aplicado al grupo.
En directorios, los archivos heredan el grupo.

*** Sticky bit
En directorios compartidos, solo el propietario puede
eliminar sus propios archivos.

Ejemplo:
/tmp

---

** Gestión Avanzada de Almacenamiento

*** LVM (Logical Volume Manager)

Permite administrar almacenamiento de forma flexible.

**** Volúmenes físicos (PV)
Discos o particiones inicializadas para LVM.

**** Grupos de volúmenes (VG)
Agrupación de múltiples PV.

**** Volúmenes lógicos (LV)
Particiones virtuales creadas dentro de un VG.

Ventaja:
Permite redimensionar sin reorganizar físicamente el disco.

** Sistemas de archivos en red

Permiten compartir almacenamiento entre máquinas.

*** NFS
Network File System.
Común en entornos Linux/Unix.

Permite montar un directorio remoto como si fuera local.

*** SMB
Server Message Block.
Protocolo usado por Windows.
En Linux se implementa mediante Samba.
